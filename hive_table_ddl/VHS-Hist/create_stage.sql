CREATE TABLE EDW.w_vehicle_hist_stg(
 	 VHS_ID                         DECIMAL(15,0),
 	 VIN                            VARCHAR(200),
 	 MESSAGE_TYPE                   VARCHAR(20 ),
 	 DEVICE_ID                      VARCHAR(15 ),
 	 EVENT_ID                       VARCHAR(200 ),
 	 EVENT_CREATION_TIME            TIMESTAMP,
 	 IGNITION_STATUS                VARCHAR(20 ),
 	 ODOMETER_VALUE                 BIGINT,
 	 ODOMETER_UNIT                  VARCHAR(10 ),
 	 LATITUDE                       DECIMAL(10,7),
 	 LONGITUDE                      DECIMAL(10,7),
 	 POSITION_HEADING_DEGREE        VARCHAR(200 ),
 	 POSITION_SPEED_KMPH            VARCHAR(200 ),
 	 POSITION_TIMESTAMP             VARCHAR(200 ),
 	 AVG_FUEL_CONSUMPTION           VARCHAR(200 ),
 	 BATTERY_VOLTAGE                VARCHAR	(200 ),
 	 DISTANCE_TO_EMPTY_FUEL         VARCHAR(200 ),
 	 DOOR_ALL_LOCK_STATUS           VARCHAR(200 ),
 	 DOOR_ALL_POSITION              VARCHAR(200 ),
 	 DOOR_ENGINE_HOOD_LOCK_STATUS   VARCHAR(200 ),
 	 DOOR_FRONT_LEFT_LOCK_STATUS    VARCHAR(200 ),
 	 DOOR_FRONT_RIGHT_LOCK_STATUS   VARCHAR(200 ),
 	 DOOR_REAR_LEFT_LOCK_STATUS     VARCHAR(200 ),
 	 DOOR_REAR_RIGHT_LOCK_STATUS    VARCHAR(200 ),
 	 DOOR_BOOT_LOCK_STATUS          VARCHAR(200 ),
 	 DOOR_ENGINE_HOOD_POSITION      VARCHAR(200 ),
 	 DOOR_FRONT_LEFT_POSITION       VARCHAR(200 ),
 	 DOOR_FRONT_RIGHT_POSITION      VARCHAR(200 ),
 	 DOOR_REAR_LEFT_POSITION        VARCHAR(200 ),
 	 DOOR_REAR_RIGHT_POSITION       VARCHAR(200 ),
 	 DOOR_BOOT_POSITION             VARCHAR(200 ),
 	 EXT_EXTERNAL_TEMP              VARCHAR(200 ),
 	 REMAINING_BATTERY_LEVEL        VARCHAR(200 ),
 	 SEAT_BELT_STATUS_FRONT_LEFT    VARCHAR(200 ),
 	 SEAT_BELT_STATUS_FRONT_MIDDLE  VARCHAR(200 ),
 	 SEAT_BELT_STATUS_FRONT_RIGHT   VARCHAR(200 ),
 	 SEAT_BELT_STATUS_SECOND_LEFT   VARCHAR(200 ),
 	 SEAT_BELT_STATUS_SECOND_MIDDLE VARCHAR(200 ),
 	 SEAT_BELT_STATUS_SECOND_RIGHT  VARCHAR(200 ),
 	 SEAT_BELT_STATUS_THIRD_LEFT    VARCHAR(200 ),
 	 SEAT_BELT_STATUS_THIRD_MIDDLE  VARCHAR(200 ),
 	 SEAT_BELT_STATUS_THIRD_RIGHT   VARCHAR(200 ),
 	 TRANSMISSION_MODE              VARCHAR(200 ),
 	 TYRE_PRESSURE_FRONT_LEFT       VARCHAR(200 ),
 	 TYRE_PRESSURE_FRONT_RIGHT      VARCHAR(200 ),
 	 TYRE_PRESSURE_REAR_LEFT        VARCHAR(200 ),
 	 TYRE_PRESSURE_REAR_RIGHT       VARCHAR(200 ),
 	 TYRE_STATUS_FRONT_LEFT         VARCHAR(200 ),
 	 TYRE_STATUS_FRONT_RIGHT        VARCHAR(200 ),
 	 TYRE_STATUS_REAR_LEFT          VARCHAR(200 ),
 	 TYRE_STATUS_REAR_RIGHT         VARCHAR(200 ),
 	 VEHICLE_STATE_TYPE             VARCHAR(200 ),
 	 WINDOW_ALL_STATUS              VARCHAR(200 ),
 	 WINDOW_BACK_STATUS             VARCHAR(200 ),
 	 WINDOW_FRONT_LEFT_STATUS       VARCHAR(200 ),
 	 WINDOW_FRONT_RIGHT_STATUS      VARCHAR(200 ),
 	 WINDOW_REAR_LEFT_STATUS        VARCHAR(20),
 	 WINDOW_REAR_RIGHT_STATUS       VARCHAR(20),
	 WINDOW_SUNROOF_STATUS          VARCHAR(20),
	 FILE_NAME 						VARCHAR(50),
 	 AUTOLOOP_FILE_NAME             VARCHAR(50),
 	 STATUS                         VARCHAR(100 ),
 	 ERROR_CODE                     VARCHAR(100 ),
 	 ERROR_MESSAGE                  VARCHAR(4000 ),
 	 EXT_EXTERNAL_TEMP_FAHRENHEIT   BIGINT,
 	 ODOMETER_VALUE_KILOMETERS      BIGINT,
 	 ODOMETER_VALUE_MILES           BIGINT,
 	 AVG_FUEL_CONSUMPTION_GAL_ML    BIGINT,
 	 TYRE_PRESSURE_FRONT_LEFT_PSI   BIGINT,
 	 TYRE_PRESSURE_FRONT_RIGHT_PSI  BIGINT,
 	 TYRE_PRESSURE_REAR_LEFT_PSI    BIGINT,
 	 TYRE_PRESSURE_REAR_RIGHT_PSI   BIGINT,
 	 DISTANCE_TO_EMPTY_FUEL_MILES   BIGINT,
 	 INITIATOR                      VARCHAR(200 ),
 	 CREATE_USER                    VARCHAR(100 ),
 	 CREATE_DATE                    VARCHAR(100 ),
 	 UPDATE_USER                    VARCHAR(100 ),
 	 UPDATE_DATE                    VARCHAR(100 ),
 	 EV_CHARGER_STATE_TYPE          VARCHAR(200 ),
 	 EV_CHARGE_SETTING_AMPERE_TYPE  VARCHAR(200 ),
 	 EV_CHARGE_VOLT_TYPE            VARCHAR(200 ),
 	 EV_STATE_OF_CHARGE_MODE        VARCHAR(200 ),
 	 EV_STATE_OF_CHARGE_PERCENT     VARCHAR(200 ),
 	 EV_VEHICLE_TIME_HOUR           VARCHAR(200 ),
 	 EV_VEHICLE_TIME_MINUTE         VARCHAR(200 ),
 	 EV_VEHICLE_TIME_SECOND         VARCHAR(200 ),
 	 EV_VEHICLE_TIME_DAYOFWEEK      VARCHAR(200 ),
 	 EV_IS_PLUGGED_IN               VARCHAR(200 ),
 	 EV_TIME_TO_FULLY_CHARGED       VARCHAR(200 ),
 	 EV_DISTANCE_TO_EMPTY           VARCHAR(200 ),
 	 EV_DISTANCE_TO_EMPTY_MILES     BIGINT,
 	 ONPREM_FILENAME		VARCHAR(200 )
 )
ROW FORMAT DELIMITED FIELDS TERMINATED BY ","
TBLPROPERTIES ('skip.header.line.count' = '1');

LOAD data INPATH '/raw/wireless-car/vhs/2019/vhs0-30.csv' INTO TABLE EDW.w_vehicle_hist_stg
LOAD data INPATH '/raw/wireless-car/vhs/2019/vhs31-60.csv' INTO TABLE EDW.w_vehicle_hist_stg
LOAD data INPATH '/raw/wireless-car/vhs/2019/vhs61-90.csv' INTO TABLE EDW.w_vehicle_hist_stg
 
 
